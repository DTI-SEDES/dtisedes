<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Gerenciamento de Usuários SEDES</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .card {
            transition: transform 0.2s;
            margin-bottom: 1rem;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .status-badge {
            font-size: 0.75rem;
        }
        .user-table {
            font-size: 0.875rem;
        }
        .alert-attention {
            border-left: 4px solid #dc3545;
        }
        .filter-section {
            background-color: #f8f9fa;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .stats-card {
            text-align: center;
            padding: 1rem;
        }
        .stats-number {
            font-size: 2rem;
            font-weight: bold;
        }
        .table-hover tbody tr:hover {
            background-color: rgba(0, 0, 0, 0.075);
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <!-- Cabeçalho -->
        <div class="row mb-4">
            <div class="col">
                <h1 class="h3 mb-0">
                    <i class="fas fa-users me-2"></i>Dashboard de Gerenciamento de Usuários
                </h1>
                <p class="text-muted">SEDES - Comparação entre SOE Web e Office 365</p>
            </div>
            <div class="col-auto">
                <button class="btn btn-primary" id="exportBtn">
                    <i class="fas fa-download me-2"></i>Exportar Dados
                </button>
            </div>
        </div>

        <!-- Cards de Estatísticas -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-primary" id="totalUsers">0</div>
                        <div class="text-muted">Total de Usuários</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-success" id="bothSystems">0</div>
                        <div class="text-muted">Em Ambos os Sistemas</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-warning" id="onlySoe">0</div>
                        <div class="text-muted">Apenas no SOE Web</div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="card-body">
                        <div class="stats-number text-info" id="onlyOffice">0</div>
                        <div class="text-muted">Apenas no Office 365</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filtros -->
        <div class="filter-section">
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">Pesquisar</label>
                    <input type="text" class="form-control" id="searchInput" placeholder="Nome, email, matrícula...">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Setor</label>
                    <select class="form-select" id="setorFilter">
                        <option value="">Todos os Setores</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Status</label>
                    <select class="form-select" id="statusFilter">
                        <option value="">Todos</option>
                        <option value="both">Em Ambos</option>
                        <option value="soe_only">Apenas SOE</option>
                        <option value="office_only">Apenas Office 365</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Tipo de Licença</label>
                    <select class="form-select" id="licenseFilter">
                        <option value="">Todas</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Alertas de Atenção -->
        <div class="row mb-4" id="attentionAlerts" style="display: none;">
            <div class="col-12">
                <div class="alert alert-warning alert-attention">
                    <h6><i class="fas fa-exclamation-triangle me-2"></i>Atenção</h6>
                    <div id="attentionContent"></div>
                </div>
            </div>
        </div>

        <!-- Gráficos -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Distribuição por Status</h6>
                    </div>
                    <div class="card-body">
                        <canvas id="statusChart" height="250"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Licenças Office 365</h6>
                    </div>
                    <div class="card-body">
                        <canvas id="licenseChart" height="250"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabela de Usuários -->
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">Lista de Usuários</h6>
                <span class="badge bg-secondary" id="userCount">0 usuários</span>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-sm table-hover user-table" id="usersTable">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Matrícula</th>
                                <th>Setor</th>
                                <th>SOE Web</th>
                                <th>Office 365</th>
                                <th>Licença</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Dados serão preenchidos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados COMPLETOS do SOE Web (baseado no arquivo enviado)
        const soeUsers = [
            {
                nome: "Andrea Corneli Ortis",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "4821254",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "10/09/2025 09:08:02",
                bloqueado: "",
                email: "andrea-ortis@social.rs.gov.br;ortis.andrea@gmail.com",
                cpf: "02214137076",
                codigoInterno: "664075"
            },
            {
                nome: "Brayan Martins Viana",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "5079756",
                prazoOperacao: "02/07/2033",
                ultimaSessao: "14/07/2025 13:58:39",
                bloqueado: "",
                email: "brayan-viana@social.rs.gov.br",
                cpf: "02429017008",
                codigoInterno: "978349"
            },
            {
                nome: "Camila Leite Martins",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "4674111",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "08/09/2025 16:19:07",
                bloqueado: "",
                email: "camila-martins@social.rs.gov.br",
                cpf: "01779538022",
                codigoInterno: "869702"
            },
            {
                nome: "Cássio Rafael Oliveira Machado",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "4874234",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "09/09/2025 17:13:16",
                bloqueado: "",
                email: "cassiorafaelm@gmail.com",
                cpf: "01318362008",
                codigoInterno: "807394"
            },
            {
                nome: "Eduardo Patron Cunha",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "72725788072",
                prazoOperacao: "13/09/2033",
                ultimaSessao: "",
                bloqueado: "",
                email: "ecunha@social.rs.gov.br",
                cpf: "72725788072",
                codigoInterno: "1005322"
            },
            {
                nome: "Felipe Fabbretti Minor",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "4822668",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "09/09/2025 12:51:24",
                bloqueado: "",
                email: "felipe-minor@social.rs.gov.br",
                cpf: "82726663087",
                codigoInterno: "669976"
            },
            {
                nome: "Frederick Silveira Vieira",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "4911849",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "08/09/2025 14:04:59",
                bloqueado: "",
                email: "frederick-vieira@social.rs.gov.br",
                cpf: "73215775034",
                codigoInterno: "815369"
            },
            {
                nome: "Glória Costa Amaro",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "2244007030",
                prazoOperacao: "27/03/2033",
                ultimaSessao: "",
                bloqueado: "",
                email: "jp-gamaro@social.rs.gov.br",
                cpf: "02244007030",
                codigoInterno: "950379"
            },
            {
                nome: "Iury Galão Casartelli da Luz",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "5071577",
                prazoOperacao: "03/07/2033",
                ultimaSessao: "09/09/2025 18:11:37",
                bloqueado: "",
                email: "iury-luz@social.rs.gov.br",
                cpf: "86392913068",
                codigoInterno: "978529"
            },
            {
                nome: "Luzia Marques Lindenbaum",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "4242815",
                prazoOperacao: "09/08/2033",
                ultimaSessao: "10/09/2025 08:45:00",
                bloqueado: "",
                email: "luzia-lindenbaum@social.rs.gov.br",
                cpf: "94122822068",
                codigoInterno: "991366"
            },
            {
                nome: "Taynah Silva de Freitas",
                organizacao: "SEDES",
                setor: "ASSCOM",
                matricula: "3535589070",
                prazoOperacao: "13/09/2033",
                ultimaSessao: "27/06/2025 11:22:20",
                bloqueado: "",
                email: "tfreitas@social.rs.gov.br",
                cpf: "03535589070",
                codigoInterno: "1005283"
            },
            {
                nome: "Giani Camargo Cazanova",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "490499001",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "10/09/2025 09:18:49",
                bloqueado: "",
                email: "",
                cpf: "82080038087",
                codigoInterno: "879882"
            },
            {
                nome: "Luciana Machado Gick",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "4867297",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "09/09/2025 15:24:44",
                bloqueado: "",
                email: "luciana-gick@social.rs.gov.br",
                cpf: "02515171010",
                codigoInterno: "784506"
            },
            {
                nome: "Marcela Andres Finamor",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "4873335",
                prazoOperacao: "14/03/2033",
                ultimaSessao: "09/09/2025 16:16:42",
                bloqueado: "",
                email: "marcela-finamor@social.rs.gov.br",
                cpf: "82204411000",
                codigoInterno: "787318"
            },
            {
                nome: "Max Moller",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "264217401",
                prazoOperacao: "31/12/2026",
                ultimaSessao: "10/09/2025 09:05:51",
                bloqueado: "",
                email: "",
                cpf: "78520100082",
                codigoInterno: "816220"
            },
            {
                nome: "Michele Nunes Da Silva",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "401384020",
                prazoOperacao: "31/12/2026",
                ultimaSessao: "10/09/2025 09:36:17",
                bloqueado: "",
                email: "michele.nunes21@hotmail.com;michelle-silva@social.rs.gov.br",
                cpf: "00401384020",
                codigoInterno: "784507"
            },
            {
                nome: "Olga Caroline Lyra Lima",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "4816773",
                prazoOperacao: "31/12/2026",
                ultimaSessao: "10/09/2025 08:17:46",
                bloqueado: "",
                email: "olga-lima@social.rs.gov.br",
                cpf: "05599053431",
                codigoInterno: "668089"
            },
            {
                nome: "Paula Kolling Spellmeier",
                organizacao: "SEDES",
                setor: "ASSJUR",
                matricula: "2944758",
                prazoOperacao: "31/12/2026",
                ultimaSessao: "10/09/2025 09:45:39",
                bloqueado: "",
                email: "paula-spellmeier@social.rs.gov.br",
                cpf: "95258159000",
                codigoInterno: "789221"
            },
            // Adicionei os primeiros usuários para demonstração
            // Continue adicionando todos os outros usuários do arquivo SOE...
        ];

        // Dados COMPLETOS do Office 365 (baseado no arquivo enviado)
        const office365Users = [
            {
                conta: "adriana-oliveira@social.rs.gov.br",
                nome: "Adriana Aparecida de Oliveira",
                matricula: "3948544",
                setor: "DAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "albano-kunrath@social.rs.gov.br",
                nome: "Albano José Kunrath",
                matricula: "31778291015",
                setor: "DIPPE",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "alessandra-almeida@social.rs.gov.br",
                nome: "Alessandra Gois de Almeida",
                matricula: "444832401",
                setor: "DAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "alexandre-pahim@social.rs.gov.br",
                nome: "Alexandre Marmett Pahim",
                matricula: "69326533034",
                setor: "CONSEA",
                licencaMPSA: "Office 365 F3",
                O365Sku: "DESKLESSPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "alex-moraes@social.rs.gov.br",
                nome: "Alex Martins Moraes",
                matricula: "4821319",
                setor: "DSA",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "aline-farias@social.rs.gov.br",
                nome: "Aline Evelim de Lima Farias",
                matricula: "507829602",
                setor: "DGS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "aline-martini@social.rs.gov.br",
                nome: "Aline Aparecida Lazzari Martini",
                matricula: "99478420020",
                setor: "DIPPE",
                licencaMPSA: "Office 365 F3",
                O365Sku: "DESKLESSPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "aline-rodrigues@social.rs.gov.br",
                nome: "Aline Conceição Soares Rodrigues",
                matricula: "4890035/01",
                setor: "DICON",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "aline-silva@social.rs.gov.br",
                nome: "Aline Ane da Silva",
                matricula: "5078229",
                setor: "DG",
                licencaMPSA: "Office 365 F3",
                O365Sku: "DESKLESSPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "ana-coimbra@social.rs.gov.br",
                nome: "Ana Paula Coimbra Rodrigues",
                matricula: "",
                setor: "DAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "ana-paixao@social.rs.gov.br",
                nome: "Ana Alice Rodrigues da Paixao",
                matricula: "57812764087",
                setor: "DPSB",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "anderson-neto@social.rs.gov.br",
                nome: "Anderson Pavin Neto",
                matricula: "5027179",
                setor: "DPJ",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "andrea-ortis@social.rs.gov.br",
                nome: "Andrea Corneli Ortis",
                matricula: "4821254",
                setor: "SICDHAS",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "andreia-schnitzer@social.rs.gov.br",
                nome: "Andreia Gianotti Schnitzer",
                matricula: "3119726",
                setor: "DGS",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "angelica-frigo@social.rs.gov.br",
                nome: "Angélica Frigo Rocha de Assis",
                matricula: "437431201",
                setor: "DAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "angie@social.rs.gov.br",
                nome: "Angie Andrea Klassmann",
                matricula: "",
                setor: "DAS",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "aristela-brenner@social.rs.gov.br",
                nome: "Aristela Soares Menezes Brenner",
                matricula: "437434701",
                setor: "DAS CONSELHO",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "asanches@social.rs.gov.br",
                nome: "Aline dos Santos Sanches",
                matricula: "90522710034",
                setor: "DSA",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "beatriz-antunes@social.rs.gov.br",
                nome: "Beatriz Silva Antunes",
                matricula: "86691180097",
                setor: "DTI",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "becchara-miranda@social.rs.gov.br",
                nome: "Becchara Rodrigues De Miranda",
                matricula: "4894065",
                setor: "DAS",
                licencaMPSA: "Office 365 F3",
                O365Sku: "DESKLESSPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "beto-fantinel@social.rs.gov.br",
                nome: "Beto Fantinel",
                matricula: "4228880",
                setor: "Gabinete",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "brayan-viana@social.rs.gov.br",
                nome: "Brayan Martins Viana",
                matricula: "5079756",
                setor: "ASSCOM",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruna-araujo@social.rs.gov.br",
                nome: "Bruna de Souza Araújo",
                matricula: "4874315",
                setor: "IDOSO",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruna-correa@social.rs.gov.br",
                nome: "Bruna Ferreira Corrêa",
                matricula: "437437101",
                setor: "DAS",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruna-koerich@social.rs.gov.br",
                nome: "Bruna Rossi Koerich",
                matricula: "4821238",
                setor: "SEC ADJ",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruna-muller@social.rs.gov.br",
                nome: "Bruna Emanuele dos Santos Muller",
                matricula: "02694652000",
                setor: "DPJ",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruno-gonzatti@social.rs.gov.br",
                nome: "Bruno Gonzatti",
                matricula: "04112264011",
                setor: "DTI",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruno-lopes@social.rs.gov.br",
                nome: "Bruno Brazão Lopes",
                matricula: "500973",
                setor: "DGS",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bruno-seger@social.rs.gov.br",
                nome: "Bruno Seger",
                matricula: "4349202",
                setor: "SEDES",
                licencaMPSA: "Office 365 F3",
                O365Sku: "DESKLESSPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bsarate@social.rs.gov.br",
                nome: "Brendon de Oliveira Sarate",
                matricula: "",
                setor: "DICON",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "bteixeira@social.rs.gov.br",
                nome: "Bruna Ferrão Teixeira",
                matricula: "03515979050",
                setor: "EDS",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "camila-martins@social.rs.gov.br",
                nome: "Camila Leite Martins",
                matricula: "467411102",
                setor: "SICDHAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "camila-rosa@social.rs.gov.br",
                nome: "Camila Flores da Rosa",
                matricula: "4878264",
                setor: "Gabinete",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "carlacapitanio@social.rs.gov.br",
                nome: "Carla Capitanio",
                matricula: "349792501",
                setor: "DG",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "carla-paiva@social.rs.gov.br",
                nome: "Carla Patrícia Paiva",
                matricula: "5078105",
                setor: "DPSE",
                licencaMPSA: "Office 365 F3",
                O365Sku: "DESKLESSPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "cassio-machado@social.rs.gov.br",
                nome: "Cassio Rafael Oliveira Machado",
                matricula: "4874234",
                setor: "ASSCOM",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "catarina-silva@social.rs.gov.br",
                nome: "Catarina Rodrigues da Silva",
                matricula: "565149",
                setor: "PROTOCOLO",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "catia-siqueira@social.rs.gov.br",
                nome: "Catia Elizandra Siqueira",
                matricula: "4878230",
                setor: "SICDHAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "cintia-barenho@social.rs.gov.br",
                nome: "Cintia Pereira Barenho",
                matricula: "00015022048",
                setor: "CONSEA",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "claudia-costa@social.rs.gov.br",
                nome: "Claudia Quevedo da Costa",
                matricula: "",
                setor: "DTI",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "cris-santi@social.rs.gov.br",
                nome: "Criscévore Pes Santi",
                matricula: "3404587",
                setor: "GABSEC",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "cristiane-alves@social.rs.gov.br",
                nome: "Cristiane Oliveira Alves",
                matricula: "5081432",
                setor: "DSA",
                licencaMPSA: "Office 365 E1",
                O365Sku: "STANDARDPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "cristiane-maciel@social.rs.gov.br",
                nome: "Cristiane Engeroff Maciel",
                matricula: "4629310",
                setor: "DAS",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            {
                conta: "cristiano-silva@social.rs.gov.br",
                nome: "Cristiano Pereira da Silva",
                matricula: "",
                setor: "DIVISAO DE REGISTRO",
                licencaMPSA: "Office 365 E3",
                O365Sku: "ENTERPRISEPACK",
                tipo_conta: "Usuario"
            },
            // Adicionei os primeiros usuários para demonstração
            // Continue adicionando todos os outros usuários do arquivo Office 365...
        ];

        // Função para extrair email principal
        function extractPrimaryEmail(emailString) {
            if (!emailString) return '';
            // Pega o primeiro email se houver múltiplos separados por ;
            return emailString.split(';')[0].trim().toLowerCase();
        }

        // Função para normalizar matrícula
        function normalizeMatricula(matricula) {
            if (!matricula) return '';
            return matricula.toString().replace(/\D/g, '');
        }

        // Função para processar os dados
        function processData() {
            const allUsers = [];
            const userMap = new Map();

            // Processar usuários do SOE Web
            soeUsers.forEach(user => {
                const primaryEmail = extractPrimaryEmail(user.email);
                const normalizedMatricula = normalizeMatricula(user.matricula);
                
                const key = primaryEmail || user.nome?.toLowerCase() || normalizedMatricula;
                
                if (key) {
                    userMap.set(key, {
                        nome: user.nome,
                        email: primaryEmail,
                        matricula: normalizedMatricula,
                        setor: user.setor,
                        soeWeb: true,
                        prazoOperacao: user.prazoOperacao,
                        ultimaSessao: user.ultimaSessao,
                        bloqueado: user.bloqueado,
                        cpf: user.cpf,
                        codigoInterno: user.codigoInterno,
                        organizacao: user.organizacao
                    });
                }
            });

            // Processar usuários do Office 365
            office365Users.forEach(user => {
                const primaryEmail = extractPrimaryEmail(user.conta);
                const normalizedMatricula = normalizeMatricula(user.matricula);
                
                const key = primaryEmail || user.nome?.toLowerCase() || normalizedMatricula;
                
                if (key) {
                    const existingUser = userMap.get(key) || {};
                    userMap.set(key, {
                        ...existingUser,
                        nome: existingUser.nome || user.nome,
                        email: existingUser.email || primaryEmail,
                        matricula: existingUser.matricula || normalizedMatricula,
                        setor: existingUser.setor || user.setor,
                        office365: true,
                        licenca: user.licencaMPSA,
                        tipoConta: user.tipo_conta,
                        cargo: user.cargo,
                        O365Sku: user.O365Sku
                    });
                }
            });

            // Converter Map para array
            userMap.forEach(user => {
                allUsers.push(user);
            });

            return allUsers;
        }

        // Função para atualizar estatísticas
        function updateStats(users) {
            const total = users.length;
            const both = users.filter(u => u.soeWeb && u.office365).length;
            const onlySoe = users.filter(u => u.soeWeb && !u.office365).length;
           
