<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEDES - An√°lise de Usu√°rios</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç SEDES - An√°lise de Usu√°rios</h1>
            <p>Plataforma de pesquisa e data science para an√°lise de contas de usu√°rios</p>
        </header>

        <!-- Se√ß√£o de Importa√ß√£o -->
        <section id="import-section" class="card">
            <h2>üì§ Importar Dados</h2>
            <div class="upload-options">
                <div class="upload-option">
                    <h3>Op√ß√£o 1: Upload de Arquivo Excel</h3>
                    <input type="file" id="file-input" accept=".xlsx, .xls">
                    <small>Formato esperado: "Usuarios geral.xlsx" com abas: User AD, User Office, user SoeWeb</small>
                </div>
                <div class="upload-option">
                    <h3>Op√ß√£o 2: Colar Dados Manualmente</h3>
                    <textarea id="json-input" placeholder="Cole aqui os dados em formato JSON..."></textarea>
                    <button onclick="importFromJSON()">Importar JSON</button>
                </div>
            </div>
            <div id="import-status"></div>
        </section>

        <!-- Painel de Estat√≠sticas -->
        <section id="stats-section" class="card" style="display: none;">
            <h2>üìä Estat√≠sticas Gerais</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total de Usu√°rios</h3>
                    <span id="total-users">0</span>
                </div>
                <div class="stat-card">
                    <h3>Contas Ativas</h3>
                    <span id="active-users">0</span>
                </div>
                <div class="stat-card">
                    <h3>Sem E-mail</h3>
                    <span id="no-email">0</span>
                </div>
                <div class="stat-card">
                    <h3>Inconsist√™ncias</h3>
                    <span id="inconsistencies">0</span>
                </div>
            </div>
        </section>

        <!-- Gr√°ficos -->
        <section id="charts-section" class="card" style="display: none;">
            <h2>üìà Visualiza√ß√µes</h2>
            <div class="charts-grid">
                <div class="chart-container">
                    <canvas id="department-chart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="status-chart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="license-chart"></canvas>
                </div>
            </div>
        </section>

        <!-- Filtros e Pesquisa -->
        <section id="filter-section" class="card" style="display: none;">
            <h2>üîç Filtros e Pesquisa</h2>
            <div class="filters">
                <input type="text" id="search-input" placeholder="Pesquisar por nome, login, departamento...">
                <select id="department-filter">
                    <option value="">Todos os Departamentos</option>
                </select>
                <select id="status-filter">
                    <option value="">Todos os Status</option>
                    <option value="Habilitada">Habilitada</option>
                    <option value="Desabilitada">Desabilitada</option>
                </select>
                <button onclick="applyFilters()">Aplicar Filtros</button>
                <button onclick="clearFilters()">Limpar</button>
            </div>
        </section>

        <!-- Tabela de Usu√°rios -->
        <section id="table-section" class="card" style="display: none;">
            <h2>üë• Lista de Usu√°rios</h2>
            <div class="table-controls">
                <button onclick="exportToPDF()">üìÑ Exportar PDF</button>
                <button onclick="exportToExcel()">üìä Exportar Excel</button>
                <button onclick="showProblematicUsers()">‚ö†Ô∏è Ver Problemas</button>
            </div>
            <div class="table-container">
                <table id="users-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Login</th>
                            <th>E-mail</th>
                            <th>Departamento</th>
                            <th>Status AD</th>
                            <th>√öltimo Logon</th>
                            <th>Licen√ßa Office</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body">
                        <!-- Dados ser√£o inseridos via JavaScript -->
                    </tbody>
                </table>
            </div>
            <div class="pagination">
                <button id="prev-page">Anterior</button>
                <span id="page-info">P√°gina 1 de 1</span>
                <button id="next-page">Pr√≥xima</button>
            </div>
        </section>

        <!-- Modal para Detalhes do Usu√°rio -->
        <div id="user-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Detalhes do Usu√°rio</h2>
                <div id="user-details">
                    <!-- Detalhes ser√£o preenchidos via JavaScript -->
                </div>
                <button onclick="printUserCard()">üñ®Ô∏è Imprimir Ficha</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script src="js/import.js"></script>
    <script src="js/analyze.js"></script>
    <script src="js/export.js"></script>
</body>
</html>
